<Activity mc:Ignorable="sap sap2010" x:Class="SendLogEmail" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_JobId" Type="InArgument(x:String)" />
    <x:Property Name="in_dt_NLogMessages" Type="InArgument(sd:DataTable)" />
    <x:Property Name="in_EndProcessTrigger" Type="InArgument(x:String)" />
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1404,8045.14285714286</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>SendLogEmail_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="48">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Excel</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="54">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="To make this workflow work, TransactionID in GetTransactionData needs to be filled with an unique (meaningful) value (e.g. TransactionItem)" DisplayName="SendLogEmail" sap:VirtualizedContainerService.HintSize="1384,7985.14285714286" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="MessageSubject" />
      <Variable x:TypeArguments="x:String" Name="MessageBody" />
      <Variable x:TypeArguments="x:String" Name="RunId" />
      <Variable x:TypeArguments="x:String" Name="AttachmentPath" />
      <Variable x:TypeArguments="x:String" Name="RunIdText" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Sequence DisplayName="Build Message Body" sap:VirtualizedContainerService.HintSize="1341.71428571429,7670.85714285714" sap2010:WorkflowViewState.IdRef="Sequence_3">
      <Sequence.Variables>
        <Variable x:TypeArguments="x:String" Name="header" />
        <Variable x:TypeArguments="x:String" Name="body1" />
        <Variable x:TypeArguments="x:String" Name="body2" />
        <Variable x:TypeArguments="x:String" Name="footer" />
        <Variable x:TypeArguments="sd:DataTable" Name="dt_MessageVariables" />
        <Variable x:TypeArguments="x:String" Name="body3" />
      </Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Read Message Settings" sap:VirtualizedContainerService.HintSize="1299.42857142857,69.7142857142857" sap2010:WorkflowViewState.IdRef="Sequence_38">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:ReadRange AddHeaders="True" DataTable="[dt_MessageVariables]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334.285714285714,86.2857142857143" sap2010:WorkflowViewState.IdRef="ReadRange_4" Range="[Nothing]" SheetName="LogMessageHtml" WorkbookPath="[in_Config(&quot;ConfigFileLocation&quot;).ToString]" />
        <ui:ReadTextFile Content="[header]" DisplayName="Read Text File" FileName="Data\LogMessageHtmlBody\header.txt" sap:VirtualizedContainerService.HintSize="334.285714285714,136" sap2010:WorkflowViewState.IdRef="ReadTextFile_1" />
        <ui:ReadTextFile Content="[body1]" DisplayName="Read Text File" FileName="Data\LogMessageHtmlBody\body1.txt" sap:VirtualizedContainerService.HintSize="334.285714285714,136" sap2010:WorkflowViewState.IdRef="ReadTextFile_2" />
        <ui:ReadTextFile Content="[body2]" DisplayName="Read Text File" FileName="Data\LogMessageHtmlBody\body2.txt" sap:VirtualizedContainerService.HintSize="334.285714285714,136" sap2010:WorkflowViewState.IdRef="ReadTextFile_5" />
        <ui:ReadTextFile Content="[body3]" DisplayName="Read Text File" FileName="Data\LogMessageHtmlBody\body3.txt" sap:VirtualizedContainerService.HintSize="334.285714285714,136" sap2010:WorkflowViewState.IdRef="ReadTextFile_9" />
        <ui:ReadTextFile Content="[footer]" DisplayName="Read Text File" FileName="Data\LogMessageHtmlBody\footer.txt" sap:VirtualizedContainerService.HintSize="334.285714285714,136" sap2010:WorkflowViewState.IdRef="ReadTextFile_6" />
      </Sequence>
      <Assign sap:VirtualizedContainerService.HintSize="1299.42857142857,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_35">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[header + body1]</InArgument>
        </Assign.Value>
      </Assign>
      <If Condition="[Not in_dt_NLogMessages.Columns.Contains(&quot;logF_TransactionStatus&quot;)]" sap:VirtualizedContainerService.HintSize="1299.42857142857,213.714285714286" sap2010:WorkflowViewState.IdRef="If_19">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If.Then>
          <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="logF_TransactionStatus" DataTable="[in_dt_NLogMessages]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="200,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_1" />
        </If.Then>
      </If>
      <If Condition="[Not in_dt_NLogMessages.Columns.Contains(&quot;logF_TransactionID&quot;)]" sap:VirtualizedContainerService.HintSize="1299.42857142857,213.714285714286" sap2010:WorkflowViewState.IdRef="If_20">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If.Then>
          <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="logF_TransactionID" DataTable="[in_dt_NLogMessages]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="200,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_2" />
        </If.Then>
      </If>
      <If Condition="[Boolean.Parse(in_Config(&quot;db_UseConnection&quot;).ToString)]" DisplayName="Get Run ID" sap:VirtualizedContainerService.HintSize="1299.42857142857,635.428571428571" sap2010:WorkflowViewState.IdRef="If_10">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If.Then>
          <Sequence DisplayName="Get run_id" sap:VirtualizedContainerService.HintSize="376.571428571429,481.714285714286" sap2010:WorkflowViewState.IdRef="Sequence_18">
            <Sequence.Variables>
              <Variable x:TypeArguments="sd:DataTable" Name="dt_JobLogId" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_JobLogId]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_5" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT id FROM &quot; + in_Config(&quot;db_JobLogTable&quot;).ToString + &quot; WHERE job_id = '&quot; + in_JobId + &quot;'&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
              <ui:ExecuteQuery.Parameters>
                <scg:Dictionary x:TypeArguments="x:String, Argument" />
              </ui:ExecuteQuery.Parameters>
            </ui:ExecuteQuery>
            <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_37">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[RunId]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[dt_JobLogId.Select()(0).Item(0).ToString]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_38">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[MessageBody.Replace("[var_runid]"," (run " + RunId + ")")]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_63">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[RunIdText]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[" (run " + RunId + ")"]</InArgument>
              </Assign.Value>
            </Assign>
          </Sequence>
        </If.Then>
        <If.Else>
          <Sequence sap:VirtualizedContainerService.HintSize="304,253.714285714286" sap2010:WorkflowViewState.IdRef="Sequence_37">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_52">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[MessageBody.Replace("[var_runid]","")]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_64">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[RunIdText]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">
                  <Literal x:TypeArguments="x:String" Value="" />
                </InArgument>
              </Assign.Value>
            </Assign>
          </Sequence>
        </If.Else>
      </If>
      <Sequence DisplayName="Build table 1" sap:VirtualizedContainerService.HintSize="1299.42857142857,1405.71428571429" sap2010:WorkflowViewState.IdRef="Sequence_30">
        <Sequence.Variables>
          <Variable x:TypeArguments="x:String" Name="StringTable1" />
          <Variable x:TypeArguments="sd:DataTable" Name="dt_Table1" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If Condition="[Boolean.Parse(in_Config(&quot;db_UseConnection&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="622.285714285714,1086.85714285714" sap2010:WorkflowViewState.IdRef="If_12">
          <If.Then>
            <Sequence DisplayName="Use database" sap:VirtualizedContainerService.HintSize="200,69.7142857142857" sap2010:WorkflowViewState.IdRef="Sequence_6">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dt_BusinessException" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_ApplicationException" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_succesvol" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_functioneleUitval" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_technischeUitval" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:BuildDataTable DataTable="[dt_Table1]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Resultaat&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Aantal&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_succesvol]" DisplayName="Filter  'Succesvol'" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_2" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT * FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE transaction_job_id = '&quot; + in_JobId + &quot;'AND datetime_end IS NOT NULL&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                <ui:ExecuteQuery.Parameters>
                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                </ui:ExecuteQuery.Parameters>
              </ui:ExecuteQuery>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Succesvol&quot;,dt_succesvol.Select.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_1" />
              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_functioneleUitval]" DisplayName="Filter  'Functionele Uitval'" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_3" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT * FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE transaction_job_id = '&quot; + in_JobId + &quot;'AND BusinessRuleException IS NOT NULL&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                <ui:ExecuteQuery.Parameters>
                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                </ui:ExecuteQuery.Parameters>
              </ui:ExecuteQuery>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Functionele uitval&quot;,dt_functioneleUitval.Select.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_2" />
              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_technischeUitval]" DisplayName="Filter  'Technische Uitval'" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_4" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT * FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE transaction_job_id = '&quot; + in_JobId + &quot;'AND SystemException IS NOT NULL&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                <ui:ExecuteQuery.Parameters>
                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                </ui:ExecuteQuery.Parameters>
              </ui:ExecuteQuery>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Technische uitval&quot;,dt_technischeUitval.Select.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_3" />
            </Sequence>
          </If.Then>
          <If.Else>
            <Sequence DisplayName="Use local file" sap:VirtualizedContainerService.HintSize="376.571428571429,933.142857142857" sap2010:WorkflowViewState.IdRef="Sequence_29">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dt_Success" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_BusinessException" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_SystemException" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:BuildDataTable DataTable="[dt_Table1]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="BuildDataTable_3" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Resultaat&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Aantal&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
              <ui:FilterDataTable DataTable="[in_dt_NLogMessages]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dt_Success]" SelectColumnsMode="Keep">
                <ui:FilterDataTable.Filters>
                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                      <ui:FilterOperationArgument.Operand>
                        <InArgument x:TypeArguments="x:String">["Success"]</InArgument>
                      </ui:FilterOperationArgument.Operand>
                    </ui:FilterOperationArgument>
                  </scg:List>
                </ui:FilterDataTable.Filters>
                <ui:FilterDataTable.SelectColumns>
                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                    <x:Null />
                  </scg:List>
                </ui:FilterDataTable.SelectColumns>
              </ui:FilterDataTable>
              <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_53">
                <Assign.To>
                  <OutArgument x:TypeArguments="sd:DataTable">[dt_Success]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="sd:DataTable">[dt_Success.DefaultView.ToTable(True,"logF_TransactionID")]</InArgument>
                </Assign.Value>
              </Assign>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Succesvol&quot;,dt_Success.Rows.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_5" />
              <ui:FilterDataTable DataTable="[in_dt_NLogMessages]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="FilterDataTable_2" OutputDataTable="[dt_BusinessException]" SelectColumnsMode="Keep">
                <ui:FilterDataTable.Filters>
                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                      <ui:FilterOperationArgument.Operand>
                        <InArgument x:TypeArguments="x:String">["BusinessException"]</InArgument>
                      </ui:FilterOperationArgument.Operand>
                    </ui:FilterOperationArgument>
                  </scg:List>
                </ui:FilterDataTable.Filters>
                <ui:FilterDataTable.SelectColumns>
                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                    <x:Null />
                  </scg:List>
                </ui:FilterDataTable.SelectColumns>
              </ui:FilterDataTable>
              <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_54">
                <Assign.To>
                  <OutArgument x:TypeArguments="sd:DataTable">[dt_BusinessException]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="sd:DataTable">[dt_BusinessException.DefaultView.ToTable(True,"logF_TransactionID")]</InArgument>
                </Assign.Value>
              </Assign>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Functionele uitval&quot;,dt_BusinessException.Rows.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_6" />
              <ui:FilterDataTable DataTable="[in_dt_NLogMessages]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="FilterDataTable_3" OutputDataTable="[dt_SystemException]" SelectColumnsMode="Keep">
                <ui:FilterDataTable.Filters>
                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                      <ui:FilterOperationArgument.Operand>
                        <InArgument x:TypeArguments="x:String">["ApplicationException"]</InArgument>
                      </ui:FilterOperationArgument.Operand>
                    </ui:FilterOperationArgument>
                  </scg:List>
                </ui:FilterDataTable.Filters>
                <ui:FilterDataTable.SelectColumns>
                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                    <x:Null />
                  </scg:List>
                </ui:FilterDataTable.SelectColumns>
              </ui:FilterDataTable>
              <Assign sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_55">
                <Assign.To>
                  <OutArgument x:TypeArguments="sd:DataTable">[dt_SystemException]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="sd:DataTable">[dt_SystemException.DefaultView.ToTable(True,"logF_TransactionID")]</InArgument>
                </Assign.Value>
              </Assign>
              <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Technische uitval&quot;,dt_SystemException.Rows.Count.ToString}]" DataTable="[dt_Table1]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_7" />
            </Sequence>
          </If.Else>
        </If>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogEmailBuildHtmlTable workflow" sap:VirtualizedContainerService.HintSize="622.285714285714,86.2857142857143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="Framework\LogEmailBuildHtmlTable.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="sd:DataTable" x:Key="in_dt_table">[dt_Table1]</InArgument>
            <OutArgument x:TypeArguments="x:String" x:Key="out_HtmlTableString">[StringTable1]</OutArgument>
            <InArgument x:TypeArguments="x:String" x:Key="in_TableWidth">250px</InArgument>
            <InArgument x:TypeArguments="s:String[]" x:Key="in_ColumnsWidth">[{"80%","20%"}]</InArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
        <Assign sap:VirtualizedContainerService.HintSize="622.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_36">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">[MessageBody + StringTable1]</InArgument>
          </Assign.Value>
        </Assign>
      </Sequence>
      <Sequence DisplayName="Build table 2" sap:VirtualizedContainerService.HintSize="1299.42857142857,1890.85714285714" sap2010:WorkflowViewState.IdRef="Sequence_32">
        <Sequence.Variables>
          <Variable x:TypeArguments="sd:DataTable" Name="dt_UitvalOverzicht" />
          <Variable x:TypeArguments="x:String" Name="StringTable2" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If Condition="[Boolean.Parse(in_Config(&quot;db_UseConnection&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="1257.14285714286,1418.28571428571" sap2010:WorkflowViewState.IdRef="If_13">
          <If.Then>
            <Sequence DisplayName="Use database" sap:VirtualizedContainerService.HintSize="200,69.7142857142857" sap2010:WorkflowViewState.IdRef="Sequence_22">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dt_UitvalOverzichtRuw" />
                <Variable x:TypeArguments="x:String" Name="Beschrijving" />
                <Variable x:TypeArguments="x:String" Name="UitvalSoort" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_UitvalOverzichtRuw]" DisplayName="Filter  'Uitval'" sap:VirtualizedContainerService.HintSize="577.142857142857,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_6" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT transaction_nr, transaction_id, BusinessRuleException, SystemException FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE transaction_job_id = '&quot; + in_JobId + &quot;'AND datetime_end IS NULL&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                <ui:ExecuteQuery.Parameters>
                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                </ui:ExecuteQuery.Parameters>
              </ui:ExecuteQuery>
              <ui:BuildDataTable DataTable="[dt_UitvalOverzicht]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="577.142857142857,58.2857142857143" sap2010:WorkflowViewState.IdRef="BuildDataTable_2" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Nr&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Kenmerk&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Uitvalsoort&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Beschrijving&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
              <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_UitvalOverzichtRuw]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="577.142857142857,1159.42857142857" sap2010:WorkflowViewState.IdRef="ForEachRow_4">
                <ui:ForEachRow.Body>
                  <ActivityAction x:TypeArguments="sd:DataRow">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                    </ActivityAction.Argument>
                    <Sequence sap:VirtualizedContainerService.HintSize="526.857142857143,1008" sap2010:WorkflowViewState.IdRef="Sequence_21">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If Condition="[Not String.IsNullOrEmpty(row.Item(&quot;BusinessRuleException&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="484.571428571429,407.428571428571" sap2010:WorkflowViewState.IdRef="If_8">
                        <If.Then>
                          <Sequence sap:VirtualizedContainerService.HintSize="304,253.714285714286" sap2010:WorkflowViewState.IdRef="Sequence_19">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_40">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[UitvalSoort]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">Functionele uitval</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_41">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[Beschrijving]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[row.Item("BusinessRuleException").ToString]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                        </If.Then>
                      </If>
                      <If Condition="[Not String.IsNullOrEmpty(row.Item(&quot;SystemException&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="484.571428571429,407.428571428571" sap2010:WorkflowViewState.IdRef="If_9">
                        <If.Then>
                          <Sequence sap:VirtualizedContainerService.HintSize="304,253.714285714286" sap2010:WorkflowViewState.IdRef="Sequence_20">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_42">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[UitvalSoort]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">Technische uitval</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_43">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[Beschrijving]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[row.Item("SystemException").ToString]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                        </If.Then>
                      </If>
                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{row.Item(&quot;transaction_nr&quot;),row.Item(&quot;transaction_id&quot;),UitvalSoort,Beschrijving}]" DataTable="[dt_UitvalOverzicht]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="484.571428571429,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_4" />
                    </Sequence>
                  </ActivityAction>
                </ui:ForEachRow.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ForEachRow>
            </Sequence>
          </If.Then>
          <If.Else>
            <Sequence DisplayName="Use local file" sap:VirtualizedContainerService.HintSize="1011.42857142857,1264.57142857143" sap2010:WorkflowViewState.IdRef="Sequence_31">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dt_Table2Rows" />
                <Variable x:TypeArguments="x:String" Name="Uitvalsoort" />
                <Variable x:TypeArguments="x:String" Name="Kenmerk" />
                <Variable x:TypeArguments="x:String" Name="Beschrijving" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:BuildDataTable DataTable="[dt_UitvalOverzicht]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="969.142857142857,58.2857142857143" sap2010:WorkflowViewState.IdRef="BuildDataTable_4" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Nr&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Kenmerk&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Uitvalsoort&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Beschrijving&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
              <ui:FilterDataTable DataTable="[in_dt_NLogMessages]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="969.142857142857,58.2857142857143" sap2010:WorkflowViewState.IdRef="FilterDataTable_4" OutputDataTable="[dt_Table2Rows]" SelectColumnsMode="Keep">
                <ui:FilterDataTable.Filters>
                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                    <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                    </ui:FilterOperationArgument>
                    <ui:FilterOperationArgument BooleanOperator="And" Operator="NOTEQ">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                      <ui:FilterOperationArgument.Operand>
                        <InArgument x:TypeArguments="x:String">["Success"]</InArgument>
                      </ui:FilterOperationArgument.Operand>
                    </ui:FilterOperationArgument>
                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                      <ui:FilterOperationArgument.Column>
                        <InArgument x:TypeArguments="x:String">["fileName"]</InArgument>
                      </ui:FilterOperationArgument.Column>
                      <ui:FilterOperationArgument.Operand>
                        <InArgument x:TypeArguments="x:String">["SetTransactionStatus"]</InArgument>
                      </ui:FilterOperationArgument.Operand>
                    </ui:FilterOperationArgument>
                  </scg:List>
                </ui:FilterDataTable.Filters>
                <ui:FilterDataTable.SelectColumns>
                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                    <x:Null />
                  </scg:List>
                </ui:FilterDataTable.SelectColumns>
              </ui:FilterDataTable>
              <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_Table2Rows]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="969.142857142857,976.571428571429" sap2010:WorkflowViewState.IdRef="ForEachRow_5">
                <ui:ForEachRow.Body>
                  <ActivityAction x:TypeArguments="sd:DataRow">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="918.857142857143,825.142857142857" sap2010:WorkflowViewState.IdRef="Sequence_33">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="ui:GenericValue" Name="Nummer" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If Condition="[row(&quot;logF_TransactionStatus&quot;).ToString = &quot;BusinessException&quot;]" sap:VirtualizedContainerService.HintSize="876.571428571429,368.571428571429" sap2010:WorkflowViewState.IdRef="If_18">
                        <If.Then>
                          <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_56">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[Uitvalsoort]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">Functionele uitval</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                        <If.Else>
                          <If Condition="[row(&quot;logF_TransactionStatus&quot;).ToString = &quot;ApplicationException&quot;]" sap:VirtualizedContainerService.HintSize="569.142857142857,214.857142857143" sap2010:WorkflowViewState.IdRef="If_17">
                            <If.Then>
                              <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_57">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Uitvalsoort]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">Technische uitval</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Then>
                            <If.Else>
                              <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_58">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Uitvalsoort]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[row("logF_TransactionStatus").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Else>
                          </If>
                        </If.Else>
                      </If>
                      <Assign sap:VirtualizedContainerService.HintSize="876.571428571429,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_65">
                        <Assign.To>
                          <OutArgument x:TypeArguments="ui:GenericValue">[Nummer]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="ui:GenericValue">[row.Item("logF_TransactionNumber").ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="876.571428571429,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_59">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[Kenmerk]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[row.Item("logF_TransactionID").ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="876.571428571429,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_60">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[Beschrijving]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[row.Item("message").ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Nummer,Kenmerk,Uitvalsoort,Beschrijving}]" DataTable="[dt_UitvalOverzicht]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="876.571428571429,21.7142857142857" sap2010:WorkflowViewState.IdRef="AddDataRow_8" />
                    </Sequence>
                  </ActivityAction>
                </ui:ForEachRow.Body>
              </ui:ForEachRow>
            </Sequence>
          </If.Else>
        </If>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogEmailBuildHtmlTable workflow" sap:VirtualizedContainerService.HintSize="1257.14285714286,86.2857142857143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="Framework\LogEmailBuildHtmlTable.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="sd:DataTable" x:Key="in_dt_table">[dt_UitvalOverzicht]</InArgument>
            <OutArgument x:TypeArguments="x:String" x:Key="out_HtmlTableString">[StringTable2]</OutArgument>
            <InArgument x:TypeArguments="x:String" x:Key="in_TableWidth">800px</InArgument>
            <InArgument x:TypeArguments="s:String[]" x:Key="in_ColumnsWidth">[{"5%","30%","20%","45%"}]</InArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
        <If Condition="[dt_UitvalOverzicht.Select().Count = 0]" sap:VirtualizedContainerService.HintSize="1257.14285714286,214.857142857143" sap2010:WorkflowViewState.IdRef="If_16">
          <If.Else>
            <Assign sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_44">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[MessageBody + body2 + StringTable2]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Else>
        </If>
      </Sequence>
      <Assign sap:VirtualizedContainerService.HintSize="1299.42857142857,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_66">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[MessageBody + body3.Replace("[EndTrigger]",in_EndProcessTrigger)]</InArgument>
        </Assign.Value>
      </Assign>
      <Sequence DisplayName="Create Attachment" sap:VirtualizedContainerService.HintSize="1299.42857142857,2312" sap2010:WorkflowViewState.IdRef="Sequence_36">
        <Sequence.Variables>
          <Variable x:TypeArguments="sd:DataTable" Name="dt_AttachmentTransactionsTable" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Assign sap:VirtualizedContainerService.HintSize="883.428571428571,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_46">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[AttachmentPath]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">[in_Config("Folder_Log").ToString + "\" + Datetime.Now.ToString("yyyy-MM-dd_HH.mm.ss") + "_TransactionLog"+RunIdText+".xlsx"]</InArgument>
          </Assign.Value>
        </Assign>
        <If Condition="[Boolean.Parse(in_Config(&quot;db_UseConnection&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="883.428571428571,1193.14285714286" sap2010:WorkflowViewState.IdRef="If_14">
          <If.Then>
            <Sequence DisplayName="Use database" sap:VirtualizedContainerService.HintSize="418.857142857143,1039.42857142857" sap2010:WorkflowViewState.IdRef="Sequence_24">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="Write sheet 'transactions'" sap:VirtualizedContainerService.HintSize="376.571428571429,948" sap2010:WorkflowViewState.IdRef="Sequence_28">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_AttachmentTransactionsTable]" DisplayName="Load DatabaseTable" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_7" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT * FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE transaction_job_id = '&quot; + in_JobId + &quot;'&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                  <ui:ExecuteQuery.Parameters>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:ExecuteQuery.Parameters>
                </ui:ExecuteQuery>
                <ui:RemoveDataColumn Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="transaction_job_id" DataTable="[dt_AttachmentTransactionsTable]" DisplayName="Remove Data Column" sap:VirtualizedContainerService.HintSize="334.285714285714,21.7142857142857" sap2010:WorkflowViewState.IdRef="RemoveDataColumn_1" />
                <Assign DisplayName="Rename Column 'transaction_id'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_48">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("transaction_id").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Nummer</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'transaction_nr'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_61">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("transaction_nr").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Transactienummer</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'datetime_start'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_45">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("datetime_start").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Tijdstip start</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'datetime_end'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_49">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("datetime_end").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Tijdstip einde</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'BusinessRuleException'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_50">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("BusinessRuleException").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Functionele uitval</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'SystemException'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_51">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("SystemException").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Technische Uitval</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign DisplayName="Rename Column 'retry_nr'" sap:VirtualizedContainerService.HintSize="334.285714285714,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_62">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[dt_AttachmentTransactionsTable.Columns("attempts").ColumnName]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Pogingen</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
            </Sequence>
          </If.Then>
          <If.Else>
            <Sequence DisplayName="Use local file" sap:VirtualizedContainerService.HintSize="418.857142857143,241.142857142857" sap2010:WorkflowViewState.IdRef="Sequence_35">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dt_Table2Rows" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="Write sheet 'transactions'" sap:VirtualizedContainerService.HintSize="376.571428571429,149.714285714286" sap2010:WorkflowViewState.IdRef="Sequence_34">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:FilterDataTable DataTable="[in_dt_NLogMessages]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334.285714285714,58.2857142857143" sap2010:WorkflowViewState.IdRef="FilterDataTable_5" OutputDataTable="[dt_AttachmentTransactionsTable]" SelectColumnsMode="Keep">
                  <ui:FilterDataTable.Filters>
                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                      <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                        <ui:FilterOperationArgument.Column>
                          <InArgument x:TypeArguments="x:String">["logF_TransactionStatus"]</InArgument>
                        </ui:FilterOperationArgument.Column>
                      </ui:FilterOperationArgument>
                      <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                        <ui:FilterOperationArgument.Column>
                          <InArgument x:TypeArguments="x:String">["fileName"]</InArgument>
                        </ui:FilterOperationArgument.Column>
                        <ui:FilterOperationArgument.Operand>
                          <InArgument x:TypeArguments="x:String">["SetTransactionStatus"]</InArgument>
                        </ui:FilterOperationArgument.Operand>
                      </ui:FilterOperationArgument>
                    </scg:List>
                  </ui:FilterDataTable.Filters>
                  <ui:FilterDataTable.SelectColumns>
                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                      <x:Null />
                    </scg:List>
                  </ui:FilterDataTable.SelectColumns>
                </ui:FilterDataTable>
              </Sequence>
            </Sequence>
          </If.Else>
        </If>
        <Sequence DisplayName="Write sheets " sap:VirtualizedContainerService.HintSize="883.428571428571,886.285714285714" sap2010:WorkflowViewState.IdRef="Sequence_27">
          <Sequence.Variables>
            <Variable x:TypeArguments="sd:DataTable" Name="dt_TransactionLast100Days" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:WriteRange AddHeaders="True" DataTable="[dt_AttachmentTransactionsTable]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="522.285714285714,114.285714285714" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="transactions" StartingCell="A1" WorkbookPath="[AttachmentPath]" />
          <ui:WriteRange AddHeaders="True" DataTable="[in_dt_NLogMessages]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="522.285714285714,114.285714285714" sap2010:WorkflowViewState.IdRef="WriteRange_2" SheetName="log" StartingCell="A1" WorkbookPath="[AttachmentPath]" />
          <If Condition="[Boolean.Parse(in_Config(&quot;db_UseConnection&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="522.285714285714,486.285714285714" sap2010:WorkflowViewState.IdRef="If_21">
            <If.Then>
              <Sequence sap:VirtualizedContainerService.HintSize="376.571428571429,332.571428571429" sap2010:WorkflowViewState.IdRef="Sequence_39">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_TransactionLast100Days]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334.285714285714,86.8571428571429" sap2010:WorkflowViewState.IdRef="ExecuteQuery_8" ProviderName="[in_Config(&quot;db_ProviderName&quot;).ToString]" Sql="[&quot;SELECT * FROM &quot; + in_Config(&quot;db_TransactionStatusTable&quot;).ToString + &quot; WHERE [datetime_start] &gt; (DATEADD([day],-100,GETDATE()))&quot;]" ConnectionString="[in_Config(&quot;db_ConnectionString&quot;).ToString]">
                  <ui:ExecuteQuery.Parameters>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:ExecuteQuery.Parameters>
                </ui:ExecuteQuery>
                <ui:WriteRange AddHeaders="True" DataTable="[dt_TransactionLast100Days]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334.285714285714,114.285714285714" sap2010:WorkflowViewState.IdRef="WriteRange_3" SheetName="TransactionsLast100Days" StartingCell="A1" WorkbookPath="[AttachmentPath]" />
              </Sequence>
            </If.Then>
          </If>
        </Sequence>
      </Sequence>
      <Assign sap:VirtualizedContainerService.HintSize="1299.42857142857,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_6">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[MessageBody + footer]</InArgument>
        </Assign.Value>
      </Assign>
      <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_MessageVariables]" DisplayName="Replace (other) variables defined in Excel-file" sap:VirtualizedContainerService.HintSize="1299.42857142857,52.5714285714286" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
        <ui:ForEachRow.Body>
          <ActivityAction x:TypeArguments="sd:DataRow">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
            </ActivityAction.Argument>
            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="833,448" sap2010:WorkflowViewState.IdRef="Sequence_9">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If Condition="[row(&quot;variable&quot;).ToString.Trim = &quot;[var_subject]&quot;]" sap:VirtualizedContainerService.HintSize="791,356" sap2010:WorkflowViewState.IdRef="If_3">
                <If.Then>
                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_10">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[MessageSubject]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[row("replace with").ToString.Trim]</InArgument>
                    </Assign.Value>
                  </Assign>
                </If.Then>
                <If.Else>
                  <If Condition="[Not String.IsNullOrEmpty(row(&quot;replace with&quot;).ToString.Trim)]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_2">
                    <If.Then>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[MessageBody.Replace((row("variable").ToString.Trim),(row("replace with").ToString.Trim))]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                  </If>
                </If.Else>
              </If>
            </Sequence>
          </ActivityAction>
        </ui:ForEachRow.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </ui:ForEachRow>
      <Assign sap:VirtualizedContainerService.HintSize="1299.42857142857,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_47">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[MessageSubject]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[MessageSubject + RunIdText]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Replace [var_datum]" sap:VirtualizedContainerService.HintSize="1299.42857142857,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_9">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[MessageBody]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[MessageBody.Replace("[var_datum]",dateTime.Now.ToString("dd-MM-yyyy, HH:mm"))]</InArgument>
        </Assign.Value>
      </Assign>
    </Sequence>
    <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[MessageBody]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="1341.71428571429,152" sap2010:WorkflowViewState.IdRef="SendOutlookMail_1" IsBodyHtml="True" IsDraft="False" Subject="[MessageSubject]" To="[in_Config(&quot;LogMessageAddress&quot;).ToString]">
      <ui:SendOutlookMail.Files>
        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
          <InArgument x:TypeArguments="x:String">[AttachmentPath]</InArgument>
        </scg:List>
      </ui:SendOutlookMail.Files>
    </ui:SendOutlookMail>
  </Sequence>
</Activity>